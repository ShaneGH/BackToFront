if(window.__BTF!=null){throw"BackToFront is defined already"}var __BTF;(function(a){a.Initialize=function(c){};var b=(function(){function c(){}c.prototype.Test=function(){return true};return c})();a.TestClass=b})(__BTF||(__BTF={}));var __extends=this.__extends||function(e,c){function a(){this.constructor=e}a.prototype=c.prototype;e.prototype=new a()};var __BTF;(function(a){var d=a.Validation;var c=a.Meta;(function(k){var j=(function(){function q(r){this.Required(r,"NodeType","ExpressionType");this.NodeType=r.NodeType;this.ExpressionType=r.ExpressionType}q.prototype.Required=function(t){var u=[];for(var r=0;r<(arguments.length-1);r++){u[r]=arguments[r+1]}if(t==null){throw"Item must have a value"}var s=linq(u).First(function(v){return t[v]==null});if(s==null){throw s+" cannot be null"}};q.prototype.Compile=function(){if(!this._Compiled){var r=this._Compile();this._Compiled=function(t,s){if(!s.Break()){r(t,s)}}}return this._Compiled};q.prototype._Compile=function(){throw"Invalid operation"};q.prototype.GetAffectedProperties=function(){return[]};q.CreateExpression=function p(r){switch(r.ExpressionType){case a.Meta.ExpressionWrapperType.Binary:return new e(r);case a.Meta.ExpressionWrapperType.Block:return new f(r);case a.Meta.ExpressionWrapperType.Conditional:return new g(r);case a.Meta.ExpressionWrapperType.Constant:return new h(r);case a.Meta.ExpressionWrapperType.Default:return new i(r);case a.Meta.ExpressionWrapperType.Member:return new l(r);case a.Meta.ExpressionWrapperType.MethodCall:return new m(r);case a.Meta.ExpressionWrapperType.Parameter:return new n(r);case a.Meta.ExpressionWrapperType.Unary:return new o(r)}throw"Invalid expression type"};return q})();k.Expression=j;var e=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Left","Right");if(!q.OperatorDictionary[this.NodeType]){throw"Invalid Operator"}this.Left=j.CreateExpression(r.Left);this.Right=j.CreateExpression(r.Right)}q.OperatorDictionary=[];q.prototype._Compile=function(){var r=this;var s=this.Left.Compile();var t=this.Right.Compile();return function(v,u){return q.OperatorDictionary[r.NodeType](s(v,u),t(v,u))}};return q})(j);k.BinaryExpression=e;var f=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Expressions");this.Expressions=linq(r.Expressions).Select(function(s){return j.CreateExpression(s)}).Result}q.prototype._Compile=function(){var r=linq(this.Expressions).Select(function(s){return s.Compile()}).Result;return function(t,s){return linq(r).Each(function(u){return u(t,s)})}};return q})(j);k.BlockExpression=f;var g=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"IfTrue","IfFalse","Test");this.IfTrue=j.CreateExpression(r.IfTrue);this.IfFalse=j.CreateExpression(r.IfFalse);this.Test=j.CreateExpression(r.Test)}q.prototype._Compile=function(){var t=this.Test.Compile();var s=this.IfTrue.Compile();var r=this.IfFalse.Compile();return function(v,u){return t(v,u)?s(v,u):r(v,u)}};return q})(j);k.ConditionalExpression=g;var h=(function(p){__extends(q,p);function q(r){p.call(this,r)}q.prototype._Compile=function(){return function(s,r){return null}};return q})(j);k.ConstantExpression=h;var i=(function(p){__extends(q,p);function q(r){p.call(this,r)}q.prototype._Compile=function(){return function(s,r){return null}};return q})(j);k.DefaultExpression=i;var l=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Expression","MemberName","Test");this.Expression=j.CreateExpression(r.Expression);this.MemberName=r.MemberName}q.RegexValues=(function(){var r="\\[[0-9]+\\]";var s="[_a-zA-Z][_a-zA-Z0-9]*("+r+")?";return{IndexedProperty:new RegExp(r+"$"),Property:new RegExp("^"+s+"$")}})();q.prototype._Compile=function(){var r=this;var s=this.Expression.Compile();return function(w,u){if(!q.RegexValues.Property.test(r.MemberName)){throw"Invalid property name: "+r.MemberName}var t=s(w,u);if(q.RegexValues.IndexedProperty.test(r.MemberName)){var x=r.MemberName.substr(0,r.MemberName.indexOf("[")-1);var v=q.RegexValues.Property.exec(r.MemberName)[0];v=parseInt(v.substring(1,v.length-1));t=t[x];if(t==null){return null}return t[v]}return t[r.MemberName]}};return q})(j);k.MemberExpression=l;var m=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Object","Arguments","MethodName","MethodFullName");this.Object=j.CreateExpression(r.Object);this.Arguments=linq(r.Arguments).Select(function(s){return j.CreateExpression(s)}).Result;this.MethodName=r.MethodName;this.MethodFullName=r.MethodFullName}q.prototype._Compile=function(){throw"Not implemented"};return q})(j);k.MethodCallExpression=m;var n=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Name");this.Name=r.Name}q.prototype._Compile=function(){var r=this;return function(t,s){return t[r.Name]}};return q})(j);k.ParameterExpression=n;var o=(function(p){__extends(q,p);function q(r){p.call(this,r);this.Required(r,"Operand");this.Operand=j.CreateExpression(r.Operand)}q.OperatorDictionary=[];q.prototype._Compile=function(){var r=this;var s=this.Operand.Compile();return function(u,t){return q.OperatorDictionary[r.NodeType](s(u,t))}};return q})(j);k.UnaryExpression=o})(a.Expressions||(a.Expressions={}));var b=a.Expressions})(__BTF||(__BTF={}));var __BTF;(function(a){(function(d){var c=(function(){function f(h,g){this.Logic=h;this.AffectedProperties=g}return f})();d.ExpressionInvoker=c;var e=(function(){function f(){}f.prototype.Break=function(){return false};return f})();d.ValidationContext=e})(a.Validation||(a.Validation={}));var b=a.Validation})(__BTF||(__BTF={}));(function(b){var c,d,e,g;var j=/^[\w\d_]+(,([\w\d_]+))*$/;var i=/^[\s\t\r\n]*\{.*\}[\s\t\r\n]*$/;var k=/[\s\t\r\n]/g;var a=function(l,m){return f(l).Union(m).Result};b.Linq=function(l){this.Result=f.utils.transformToArray(l)};b.linq=function(l){return new b.Linq(l?l:[])};var f=b.linq;f.utils={convertLambda:function(l){if(!l||l.constructor===Function){return l}else{if(l.constructor!==String){throw"Invalid linq function"}else{if(l.indexOf("=>")===-1){throw'"=>" expression not found'}}}var n=l.substring(l.indexOf("=>")+2);var m=l.substring(0,l.indexOf("=>")).replace(k,"");if(m.indexOf("(")===0){m=m.substring(1);if(m.indexOf(")")===m.length-1){m=m.substring(0,m.length-1)}else{throw"Invalid left hand side"}}if(m.length<1||!j.test(m)){throw"Invalid left hand side"}else{if(n.length<1){throw"Invalid right hand side"}}if(i.test(n)){return new Function(m,n)}else{return new Function(m,"return "+n+";")}},transformToArray:function(l){if(l.constructor===Array){return l}else{if(l.constructor===b.Linq){return l.Result}else{if(l.constructor===NodeList){return l}else{throw"Input must be array or Linq object"}}}},transformToLinq:function(l){if(l.constructor===b.Linq){return l}else{if(l.constructor===Array){return f(l)}else{throw"Input must be array or Linq object"}}}};f.fn=b.Linq.prototype;f.fn.Select=function(o){o=f.utils.convertLambda(o);var n=f();for(var l=0,m=this.Result.length;l<m;l++){n.Result[l]=o(this.Result[l])}return n};var h=function(m,n){n=f.utils.convertLambda(n);var l=function(p){return p!=null&&p.constructor===Number};var o=(n?m.Select(n):m).Where(l).Result;if(o.length===0){throw"Sequence contains no elements."}return o};f.fn.Max=function(l){return Math.max.apply(Math,h(this,l))};f.fn.Min=function(l){return Math.min.apply(Math,h(this,l))};f.fn.Aggregate=function(l){if(l===undefined){l=a}else{l=f.utils.convertLambda(l)}var o=f();for(var m=0,n=this.Result.length;m<n;m++){o.Result=l(o.Result,this.Result[m])}return o};f.fn.Union=function(l){l=f.utils.transformToArray(l);var p=f();var m;for(m=0,c=this.Result.length;m<c;m++){p.Result[m]=this.Result[m]}for(var n=0,o=l.length;n<o;n++){if(!p.Contains(l[n])){p.Result[m+n]=l[n]}else{m--}}return p};f.fn.Contains=function(l){for(var m=0,n=this.Result.length;m<n;m++){if(this.Result[m]===l){return true}}return false};f.fn.Any=function(n){if(!n){return this.Result.length>0}n=f.utils.convertLambda(n);for(var l=0,m=this.Result.length;l<m;l++){if(n(this.Result[l])){return true}}return false};f.fn.Where=function(p){p=f.utils.convertLambda(p);var o=0;var n=f();for(var l=0,m=this.Result.length;l<m;l++){if(p(this.Result[l])){n.Result[l-o]=this.Result[l]}else{o++}}return n};f.fn.First=function(n){if(!n){return this.Result[0]}else{n=f.utils.convertLambda(n);for(var l=0,m=this.Result.length;l<m;l++){if(n(this.Result[l])){return this.Result[l]}}}return null};f.fn.Last=function(m){if(!m){return this.Result[this.Result.length-1]}else{m=f.utils.convertLambda(m);for(var l=this.Result.length-1;l>=0;l--){if(m(this.Result[l])){return this.Result[l]}}}return null};f.fn.GroupBy=function(p){p=f.utils.convertLambda(p);var o=f();var n=null;var q=null;for(var l=0,m=this.Result.length;l<m;l++){n=p(this.Result[l]);q=o.Where(function(r){return r.key===n});if(q.Any()){q.Result[0].values.push(this.Result[l])}else{o.Result.push({key:n,values:[this.Result[l]]})}}return o};f.fn.OrderBy=function(q){q=f.utils.convertLambda(q);var l=new Object();var o=f();var u=[];var t=[];var s=null;for(var m=0,n=this.Result.length;m<n;m++){var p=q?q(this.Result[m]):this.Result[m];u[m]={key:m,value:p};t[m]={key:m,value:this.Result[m]};if(p&&s==null){s=typeof p==="number"?l:p.constructor}else{if(p&&s!==(typeof p==="number"?l:p.constructor)){throw"Invalid comparison type"}}}var r=function(v,w){if(v.value<w.value){return -1}else{if(v.value>w.value){return 1}else{return 0}}};u.sort(r);for(var m=0,n=u.length;m<n;m++){o.Result[m]=f(t).First(function(v){return v.key===u[m].key}).value}return o};f.fn.OrderByDecending=function(m){var l=this.OrderBy(f.utils.convertLambda(m));l.Result.reverse();return l};f.fn.Skip=function(o){var n=f();for(var l=o,m=this.Result.length;l<m;l++){n.Result[l-o]=this.Result[l]}return n};f.fn.Take=function(o){var n=f();var m=o<this.Result.length?o:this.Result.length;for(var l=0;l<m;l++){n.Result[l]=this.Result[l]}return n};f.fn.Distinct=function(){var o=0;var n=f();for(var l=0,m=this.Result.length;l<m;l++){if(!n.Contains(this.Result[l])){n.Result[l-o]=this.Result[l]}else{o++}}return n};f.fn.Each=function(n){n=f.utils.convertLambda(n);for(var l=0,m=this.Result.length;l<m;l++){n(this.Result[l],l)}return this};f.fn.ReverseEach=function(m){m=f.utils.convertLambda(m);for(var l=this.Result.length-1;l>=0;l--){m(this.Result[l],l)}return this}})(window);