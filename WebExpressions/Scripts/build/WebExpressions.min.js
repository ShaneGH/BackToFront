(function(){(function(e){var f,g,h,j;var m=/^[\w\d_]+(,([\w\d_]+))*$/;var l=/^[\s\t\r\n]*\{.*\}[\s\t\r\n]*$/;var n=/[\s\t\r\n]/g;var d=function(o,p){return i(o).Union(p).Result};e.Linq=function(o){this.Result=i.utils.transformToArray(o)};e.linq=function(o){return new e.Linq(o?o:[])};var i=e.linq;i.utils={convertLambda:function(o){if(!o||o.constructor===Function){return o}else{if(o.constructor!==String){throw"Invalid linq function"}else{if(o.indexOf("=>")===-1){throw'"=>" expression not found'}}}var q=o.substring(o.indexOf("=>")+2);var p=o.substring(0,o.indexOf("=>")).replace(n,"");if(p.indexOf("(")===0){p=p.substring(1);if(p.indexOf(")")===p.length-1){p=p.substring(0,p.length-1)}else{throw"Invalid left hand side"}}if(p.length<1||!m.test(p)){throw"Invalid left hand side"}else{if(q.length<1){throw"Invalid right hand side"}}if(l.test(q)){return new Function(p,q)}else{return new Function(p,"return "+q+";")}},transformToArray:function(o){if(o.constructor===Array){return o}else{if(o.constructor===e.Linq){return o.Result}else{if(o.constructor===NodeList){return o}else{throw"Input must be array or Linq object"}}}},transformToLinq:function(o){if(o.constructor===e.Linq){return o}else{if(o.constructor===Array){return i(o)}else{throw"Input must be array or Linq object"}}}};i.fn=e.Linq.prototype;i.fn.Select=function(r){r=i.utils.convertLambda(r);var q=i();for(var o=0,p=this.Result.length;o<p;o++){q.Result[o]=r(this.Result[o])}return q};var k=function(p,q){q=i.utils.convertLambda(q);var o=function(s){return s!=null&&s.constructor===Number};var r=(q?p.Select(q):p).Where(o).Result;if(r.length===0){throw"Sequence contains no elements."}return r};i.fn.Max=function(o){return Math.max.apply(Math,k(this,o))};i.fn.Min=function(o){return Math.min.apply(Math,k(this,o))};i.fn.Aggregate=function(o){if(o===undefined){o=d}else{o=i.utils.convertLambda(o)}var r=i();for(var p=0,q=this.Result.length;p<q;p++){r.Result=o(r.Result,this.Result[p])}return r};i.fn.Union=function(o){o=i.utils.transformToArray(o);var s=i();var p;for(p=0,f=this.Result.length;p<f;p++){s.Result[p]=this.Result[p]}for(var q=0,r=o.length;q<r;q++){if(!s.Contains(o[q])){s.Result[p+q]=o[q]}else{p--}}return s};i.fn.Contains=function(o){for(var p=0,q=this.Result.length;p<q;p++){if(this.Result[p]===o){return true}}return false};i.fn.Any=function(q){if(!q){return this.Result.length>0}q=i.utils.convertLambda(q);for(var o=0,p=this.Result.length;o<p;o++){if(q(this.Result[o])){return true}}return false};i.fn.Where=function(s){s=i.utils.convertLambda(s);var r=0;var q=i();for(var o=0,p=this.Result.length;o<p;o++){if(s(this.Result[o])){q.Result[o-r]=this.Result[o]}else{r++}}return q};i.fn.First=function(q){if(!q){return this.Result[0]}else{q=i.utils.convertLambda(q);for(var o=0,p=this.Result.length;o<p;o++){if(q(this.Result[o])){return this.Result[o]}}}return null};i.fn.Last=function(p){if(!p){return this.Result[this.Result.length-1]}else{p=i.utils.convertLambda(p);for(var o=this.Result.length-1;o>=0;o--){if(p(this.Result[o])){return this.Result[o]}}}return null};i.fn.GroupBy=function(s){s=i.utils.convertLambda(s);var r=i();var q=null;var t=null;for(var o=0,p=this.Result.length;o<p;o++){q=s(this.Result[o]);t=r.Where(function(u){return u.key===q});if(t.Any()){t.Result[0].values.push(this.Result[o])}else{r.Result.push({key:q,values:[this.Result[o]]})}}return r};i.fn.OrderBy=function(t){t=i.utils.convertLambda(t);var o=new Object();var r=i();var x=[];var w=[];var v=null;for(var p=0,q=this.Result.length;p<q;p++){var s=t?t(this.Result[p]):this.Result[p];x[p]={key:p,value:s};w[p]={key:p,value:this.Result[p]};if(s&&v==null){v=typeof s==="number"?o:s.constructor}else{if(s&&v!==(typeof s==="number"?o:s.constructor)){throw"Invalid comparison type"}}}var u=function(y,z){if(y.value<z.value){return -1}else{if(y.value>z.value){return 1}else{return 0}}};x.sort(u);for(var p=0,q=x.length;p<q;p++){r.Result[p]=i(w).First(function(y){return y.key===x[p].key}).value}return r};i.fn.OrderByDecending=function(p){var o=this.OrderBy(i.utils.convertLambda(p));o.Result.reverse();return o};i.fn.Skip=function(r){var q=i();for(var o=r,p=this.Result.length;o<p;o++){q.Result[o-r]=this.Result[o]}return q};i.fn.Take=function(r){var q=i();var p=r<this.Result.length?r:this.Result.length;for(var o=0;o<p;o++){q.Result[o]=this.Result[o]}return q};i.fn.Distinct=function(){var r=0;var q=i();for(var o=0,p=this.Result.length;o<p;o++){if(!q.Contains(this.Result[o])){q.Result[o-r]=this.Result[o]}else{r++}}return q};i.fn.Each=function(q){q=i.utils.convertLambda(q);for(var o=0,p=this.Result.length;o<p;o++){q(this.Result[o],o)}return this};i.fn.ReverseEach=function(p){p=i.utils.convertLambda(p);for(var o=this.Result.length-1;o>=0;o--){p(this.Result[o],o)}return this}})(window);var c;(function(e){(function(h){var g=(function(){function i(j,k){this.Key=j;this.Value=k}return i})();var f=(function(){function i(){this._InnerDictionary=[]}i.prototype.ContainsKey=function(j){return linq(this._InnerDictionary).Any(function(k){return k.Key===j})};i.prototype.Add=function(j,k){if(this.ContainsKey(j)){throw"Dictionary alredy contains the key "+j}this._InnerDictionary.push(new g(j,k))};i.prototype.AddOrReplace=function(k,l){var j=linq(this._InnerDictionary).First(function(m){return m.Key===k});if(j){j.Value=l}else{this._InnerDictionary.push(new g(k,l))}};i.prototype.Value=function(k){var j=linq(this._InnerDictionary).First(function(l){return l.Key===k});return j?j.Value:null};i.prototype.Remove=function(l){for(var j=0,k=this._InnerDictionary.length;j<k;j++){if(this._InnerDictionary[j].Key===l){this._InnerDictionary.splice(j,1);return true}}return false};i.prototype.Merge=function(j){if(j){for(var k=0,l=j._InnerDictionary.length;k<l;k++){var m=j._InnerDictionary[k];this.Add(m.Key,m.Value)}}return this};return i})();h.Dictionary=f})(e.Utils||(e.Utils={}));var d=e.Utils})(c||(c={}));var c;(function(e){(function(h){(function(i){i._map=[];i.Binary=1;i.Constant=2;i.Member=3;i.MethodCall=4;i.Parameter=5;i.Unary=6;i.Default=7;i.Block=8;i.Conditional=9;i.Invocation=10;i.New=11})(h.ExpressionWrapperType||(h.ExpressionWrapperType={}));var g=h.ExpressionWrapperType;(function(i){i._map=[];i.Add=0;i.AddChecked=1;i.And=2;i.AndAlso=3;i.ArrayLength=4;i.ArrayIndex=5;i.Call=6;i.Coalesce=7;i.Conditional=8;i.Constant=9;i.Convert=10;i.ConvertChecked=11;i.Divide=12;i.Equal=13;i.ExclusiveOr=14;i.GreaterThan=15;i.GreaterThanOrEqual=16;i.Invoke=17;i.Lambda=18;i.LeftShift=19;i.LessThan=20;i.LessThanOrEqual=21;i.ListInit=22;i.MemberAccess=23;i.MemberInit=24;i.Modulo=25;i.Multiply=26;i.MultiplyChecked=27;i.Negate=28;i.UnaryPlus=29;i.NegateChecked=30;i.New=31;i.NewArrayInit=32;i.NewArrayBounds=33;i.Not=34;i.NotEqual=35;i.Or=36;i.OrElse=37;i.Parameter=38;i.Power=39;i.Quote=40;i.RightShift=41;i.Subtract=42;i.SubtractChecked=43;i.TypeAs=44;i.TypeIs=45;i.Assign=46;i.Block=47;i.DebugInfo=48;i.Decrement=49;i.Dynamic=50;i.Default=51;i.Extension=52;i.Goto=53;i.Increment=54;i.Index=55;i.Label=56;i.RuntimeVariables=57;i.Loop=58;i.Switch=59;i.Throw=60;i.Try=61;i.Unbox=62;i.AddAssign=63;i.AndAssign=64;i.DivideAssign=65;i.ExclusiveOrAssign=66;i.LeftShiftAssign=67;i.ModuloAssign=68;i.MultiplyAssign=69;i.OrAssign=70;i.PowerAssign=71;i.RightShiftAssign=72;i.SubtractAssign=73;i.AddAssignChecked=74;i.MultiplyAssignChecked=75;i.SubtractAssignChecked=76;i.PreIncrementAssign=77;i.PreDecrementAssign=78;i.PostIncrementAssign=79;i.PostDecrementAssign=80;i.TypeEqual=81;i.OnesComplement=82;i.IsTrue=83;i.IsFalse=84})(h.ExpressionType||(h.ExpressionType={}));var f=h.ExpressionType})(e.Meta||(e.Meta={}));var d=e.Meta})(c||(c={}));var c;(function(e){var d=(function(){function g(h){e.Sanitizer.Require(h,{inputName:"NodeType",inputConstructor:Number},{inputName:"ExpressionType",inputConstructor:Number});this.NodeType=h.NodeType;this.ExpressionType=h.ExpressionType}g.prototype.Compile=function(){if(!this._Compiled){this._Compiled=this._Compile()}return this._Compiled};g.prototype.EvalCompile=function(){if(!this._EvalCompiled){var i=this.EvalExpression();var h=new Function(e.ConstantExpression.ConstantParameter,i.Expression);this._EvalCompiled=function(){return h(i.Constants)}}return this._EvalCompiled};g.prototype._Compile=function(){throw"Invalid operation"};g.prototype.EvalExpression=function(){throw"Invalid operation"};g.prototype.GetAffectedProperties=function(){return[]};g.ExpressionConstructorDictionary=(function(){var h={};h[e.Meta.ExpressionWrapperType.Binary]=function(i){return new e.BinaryExpression(i)};h[e.Meta.ExpressionWrapperType.Block]=function(i){return new e.BlockExpression(i)};h[e.Meta.ExpressionWrapperType.Conditional]=function(i){return new e.ConditionalExpression(i)};h[e.Meta.ExpressionWrapperType.Constant]=function(i){return new e.ConstantExpression(i)};h[e.Meta.ExpressionWrapperType.Default]=function(i){return new e.DefaultExpression(i)};h[e.Meta.ExpressionWrapperType.Member]=function(i){return new e.MemberExpression(i)};h[e.Meta.ExpressionWrapperType.MethodCall]=function(i){return new e.MethodCallExpression(i)};h[e.Meta.ExpressionWrapperType.Parameter]=function(i){return new e.ParameterExpression(i)};h[e.Meta.ExpressionWrapperType.Unary]=function(i){return new e.UnaryExpression(i)};h[e.Meta.ExpressionWrapperType.Invocation]=function(i){return new e.InvocationExpression(i)};h[e.Meta.ExpressionWrapperType.New]=function(i){return new e.NewExpression(i)};return h})();g.CreateExpression=function f(h){if(h.NodeType===e.Meta.ExpressionType.Assign&&h.ExpressionType===e.Meta.ExpressionWrapperType.Binary){return new e.AssignmentExpression(h)}if(g.ExpressionConstructorDictionary[h.ExpressionType]){return g.ExpressionConstructorDictionary[h.ExpressionType](h)}throw"Invalid expression type"};return g})();e.Expression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Left",inputType:"object"},{inputName:"Right",inputType:"object"});switch(h.Left.ExpressionType){case e.Meta.ExpressionWrapperType.Parameter:this.Left=null;this.LeftProperty=(h.Left).Name;break;case e.Meta.ExpressionWrapperType.Member:this.Left=e.Expression.CreateExpression((h.Left).Expression);this.LeftProperty=(h.Left).MemberName;break;default:throw"The left hand side of an assignment must be a parameter or a member"}this.Right=e.Expression.CreateExpression(h.Right)}g.prototype.EvalExpression=function(){var i=this.Right.EvalExpression();var h=this.Left?this.Left.EvalExpression():null;if(h){i.Constants.Merge(h.Constants)}return{Expression:"("+(h?h.Expression+".":"")+this.LeftProperty+" = "+i.Expression+")",Constants:i.Constants}};g.prototype._Compile=function(){var h=this;var i=this.Left?this.Left.Compile():function(k){return k};var j=this.Right.Compile();return function(k){return i(k)[h.LeftProperty]=j(k)}};return g})(e.Expression);e.AssignmentExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(f){var e=f.Meta;var d=(function(g){a(h,g);function h(i){g.call(this,i);if(!h.OperatorDictionary[this.NodeType]){throw"##Invalid Operator"}f.Sanitizer.Require(i,{inputName:"Left",inputType:"object"},{inputName:"Right",inputType:"object"});this.Left=f.Expression.CreateExpression(i.Left);this.Right=f.Expression.CreateExpression(i.Right)}h.OperatorDictionary=(function(){var i=[];i[f.Meta.ExpressionType.Add]=function(j,k){return j+k};i[f.Meta.ExpressionType.AndAlso]=function(j,k){return j&&k};i[f.Meta.ExpressionType.Divide]=function(j,k){return j/k};i[f.Meta.ExpressionType.Equal]=function(j,k){return j===k};i[f.Meta.ExpressionType.GreaterThan]=function(j,k){return j>k};i[f.Meta.ExpressionType.GreaterThanOrEqual]=function(j,k){return j>=k};i[f.Meta.ExpressionType.LessThan]=function(j,k){return j<k};i[f.Meta.ExpressionType.LessThanOrEqual]=function(j,k){return j<=k};i[f.Meta.ExpressionType.Multiply]=function(j,k){return j*k};i[f.Meta.ExpressionType.NotEqual]=function(j,k){return j!==k};i[f.Meta.ExpressionType.OrElse]=function(j,k){return j||k};i[f.Meta.ExpressionType.Subtract]=function(j,k){return j-k};return i})();h.OperatorStringDictionary=(function(){var i=[];i[f.Meta.ExpressionType.Add]=" + ";i[f.Meta.ExpressionType.AndAlso]=" && ";i[f.Meta.ExpressionType.Divide]=" / ";i[f.Meta.ExpressionType.Equal]=" === ";i[f.Meta.ExpressionType.GreaterThan]=" > ";i[f.Meta.ExpressionType.GreaterThanOrEqual]=" >= ";i[f.Meta.ExpressionType.LessThan]=" < ";i[f.Meta.ExpressionType.LessThanOrEqual]=" <= ";i[f.Meta.ExpressionType.Multiply]=" * ";i[f.Meta.ExpressionType.NotEqual]=" !== ";i[f.Meta.ExpressionType.OrElse]=" || ";i[f.Meta.ExpressionType.Subtract]=" - ";return i})();h.prototype.EvalExpression=function(){if(!h.OperatorStringDictionary[this.NodeType]){throw"Invalid expression type"}var i=this.Left.EvalExpression();var j=this.Right.EvalExpression();return{Expression:"("+i.Expression+h.OperatorStringDictionary[this.NodeType]+j.Expression+")",Constants:i.Constants.Merge(j.Constants)}};h.prototype._Compile=function(){var i=this;if(!h.OperatorStringDictionary[this.NodeType]){throw"Invalid expression type"}var j=this.Left.Compile();var k=this.Right.Compile();return function(l){return h.OperatorDictionary[i.NodeType](j(l),k(l))}};return h})(f.Expression);f.BinaryExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Expressions",inputConstructor:Array});this.Expressions=linq(h.Expressions).Select(function(i){return e.Expression.CreateExpression(i)}).Result}g.prototype.EvalExpression=function(){var h=linq(this.Expressions).Select(function(i){return i.EvalExpression()}).Result;if(!h.length){return{Constants:new e.Utils.Dictionary(),Expression:""}}for(var j=1,k=h.length;j<k;j++){h[0].Constants.Merge(h[j].Constants)}return{Expression:linq(h).Select(function(i){return i.Expression}).Result.join(";\n"),Constants:h[0].Constants}};g.prototype._Compile=function(){var h=linq(this.Expressions).Select(function(i){return i.Compile()}).Result;return function(i){return linq(h).Each(function(j){return j(i)})}};return g})(e.Expression);e.BlockExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"IfTrue",inputType:"object"},{inputName:"IfFalse",inputType:"object"},{inputName:"Test",inputType:"object"});this.IfTrue=e.Expression.CreateExpression(h.IfTrue);this.IfFalse=e.Expression.CreateExpression(h.IfFalse);this.Test=e.Expression.CreateExpression(h.Test)}g.prototype.EvalExpression=function(){if(this.IfTrue.ExpressionType===e.Meta.ExpressionWrapperType.Block||this.IfFalse.ExpressionType===e.Meta.ExpressionWrapperType.Block){return this._ToBlockString()}return this._ToInlineString()};g.prototype._ToInlineString=function(){var j=this.Test.EvalExpression();var i=this.IfTrue.EvalExpression();var h=this.IfFalse.EvalExpression();return{Constants:j.Constants.Merge(i.Constants).Merge(h.Constants),Expression:"("+j.Expression+" ? "+i.Expression+" : "+h.Expression+")"}};g.prototype._ToBlockString=function(){var j=this.Test.EvalExpression();var i=this.IfTrue.EvalExpression();var h=this.IfFalse.EvalExpression();return{Constants:j.Constants.Merge(i.Constants).Merge(h.Constants),Expression:"if("+j.Expression+") { "+i.Expression+" } else { "+h.Expression+" }"}};g.prototype._Compile=function(){var j=this.Test.Compile();var i=this.IfTrue.Compile();var h=this.IfFalse.Compile();return function(k){return j(k)?i(k):h(k)}};return g})(e.Expression);e.ConditionalExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);this.Value=h.Value}g.ConstantParameter="__constants";g.GenerateConstantId=(function(){var h=0;return function(){return"constant-"+(++h)}})();g.prototype.EvalExpression=function(){var h=g.GenerateConstantId();var i=new e.Utils.Dictionary();i.Add(h,this.Value);return{Constants:i,Expression:g.ConstantParameter+"["+h+"]"}};g.prototype._Compile=function(){var h=this;return function(i){return h.Value}};return g})(e.Expression);e.ConstantExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h)}g.prototype.EvalExpression=function(){return{Expression:"",Constants:new e.Utils.Dictionary()}};g.prototype._Compile=function(){return function(h){return null}};return g})(e.Expression);e.DefaultExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Expression",inputType:"object"},{inputName:"Arguments",inputConstructor:Array});this.Expression=e.Expression.CreateExpression(h.Expression);this.Arguments=linq(h.Arguments).Select(function(i){return e.Expression.CreateExpression(i)}).Result}g.prototype.EvalExpression=function(){var i=this.Expression.EvalExpression();var h=linq(this.Arguments).Select(function(j){return j.EvalExpression()});linq(h).Each(function(j){return i.Constants.Merge(j.Constants)});return{Constants:i.Constants,Expression:i.Expression+"("+linq(h).Select(function(j){return j.Expression}).Result.join(", ")+")"}};g.prototype._Compile=function(){var i=this.Expression.Compile();var h=linq(this.Arguments).Select(function(j){return j.Compile()}).Result;return function(j){var k=i(j);var l=linq(h).Select(function(m){return m(j)}).Result;return k.apply(j,l)}};return g})(e.Expression);e.InvocationExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Expression",inputType:"object",allowNull:true},{inputName:"MemberName",inputConstructor:String});this.Expression=h.Expression?e.Expression.CreateExpression(h.Expression):null;this.MemberName=h.MemberName}g.PropertyRegex=new RegExp("^[_a-zA-Z][_a-zA-Z0-9]*$");g.prototype.EvalExpression=function(){throw"Not implemented, need to split into static and non static member references";if(!g.PropertyRegex.test(this.MemberName)){throw"Invalid property name: "+this.MemberName}var h=this.Expression.EvalExpression();return{Expression:h.Expression+"."+this.MemberName,Constants:h.Constants}};g.prototype._Compile=function(){if(!g.PropertyRegex.test(this.MemberName)){throw"Invalid property name: "+this.MemberName}if(this.Expression){var i=this.MemberName;var h=this.Expression.Compile();return function(j){return h(j)[i]}}else{throw"Not implemented exception"}};return g})(e.Expression);e.MemberExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Object",inputType:"object",allowNull:true},{inputName:"Arguments",inputConstructor:Array},{inputName:"MethodName",inputConstructor:String},{inputName:"MethodFullName",inputConstructor:String});this.Object=h.Object?e.Expression.CreateExpression(h.Object):null;this.Arguments=linq(h.Arguments).Select(function(i){return e.Expression.CreateExpression(i)}).Result;this.MethodName=h.MethodName;this.MethodFullName=h.MethodFullName}g.prototype.EvalExpression=function(){throw"Not implemented, need to split into static and non static method calls";if(!e.MemberExpression.PropertyRegex.test(this.MethodName)){throw"Invalid method name: "+this.MethodName}var h=linq(this.Arguments).Select(function(k){return k.EvalExpression()}).Result;var j=this.Object?this.Object.EvalExpression():{Expression:"window",Constants:new e.Utils.Dictionary()};linq(h).Each(function(k){return j.Constants.Merge(k.Constants)});var i='__o["'+this.MethodName+'"]';return{Expression:"(function (__o) { return ("+i+" ? "+i+' : ex.ns.MethodCallExpression.RegisteredMethods["'+this.MethodFullName+'"]).call(__o, '+h.join(", ")+"); })("+j.Expression+")",Constants:j.Constants}};g.prototype._Compile=function(){var h=this;if(!e.MemberExpression.PropertyRegex.test(this.MethodName)){throw"Invalid method name: "+this.MethodName}var j=this.Object?this.Object.Compile():function(k){return window};var i=linq(this.Arguments).Select(function(k){return k.Compile()}).Result;return function(k){var l=j(k);var m=linq(i).Select(function(n){return n(k)}).Result;return(l[h.MethodName]?l[h.MethodName]:g.RegisteredMethods[h.MethodFullName]).apply(l,m)}};g.RegisteredMethods={};return g})(e.Expression);e.MethodCallExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(h,f);function h(i){f.call(this,i);e.Sanitizer.Require(i,{inputName:"Arguments",inputConstructor:Array},{inputName:"IsAnonymous",inputConstructor:Boolean},{inputName:"Type",inputConstructor:String});if(i.IsAnonymous){e.Sanitizer.Require(i,{inputName:"Members",inputConstructor:Array});if(i.Members.length!==i.Arguments.length){throw"If members are defined, each must have a corresponding argument"}}this.Arguments=linq(i.Arguments).Select(function(j){return e.Expression.CreateExpression(j)}).Result;this.Members=i.Members;this.Type=i.Type;this.IsAnonymous=i.IsAnonymous}h.prototype.EvalExpression=function(){var i=linq(this.Arguments).Select(function(l){return l.EvalExpression()}).Result;var k=new e.Utils.Dictionary();linq(i).Each(function(l){return k.Merge(l.Constants)});var j=linq(i).Select(function(l){return l.Expression}).Result.join(", ");if(this.IsAnonymous){return{Constants:k,Expression:"{ "+j+" }"}}else{if(h.RegisteredTypes[this.Type]){return{Constants:k,Expression:'new ex.ns.NewExpression.RegisteredTypes["'+this.Type+'"]('+j+")"}}else{return{Constants:k,Expression:"{}"}}}};h.prototype._Compile=function(){var i=this;var j=linq(this.Arguments).Select(function(k){return k.Compile()}).Result;return function(k){var l=linq(j).Select(function(m){return m(k)}).Result;if(i.IsAnonymous){return i.ConstructAnonymous(l)}else{if(h.RegisteredTypes[i.Type]){return h.Construct(h.RegisteredTypes[i.Type],l)}else{return{}}}}};h.prototype.ConstructAnonymous=function(m){var l={};for(var j=0,k=this.Members.length;j<k;j++){l[this.Members[j]]=m[j]}return l};h.Construct=function g(j,i){var k=Object.create(j.prototype);var l=j.apply(k,i);return typeof l==="object"?l:k};h.RegisteredTypes={};return h})(e.Expression);e.NewExpression=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Name",inputConstructor:String});this.Name=h.Name}g.prototype.EvalExpression=function(){return{Expression:this.Name,Constants:new e.Utils.Dictionary()}};g.prototype._Compile=function(){var h=this;return function(i){return i[h.Name]}};return g})(e.Expression);e.ParameterExpression=d})(c||(c={}));var c;(function(e){e.Initialize=function(f){};var d=(function(){function g(){}g.Require=function f(l){var n=[];for(var h=0;h<(arguments.length-1);h++){n[h]=arguments[h+1]}if(l==null){throw"Item must have a value"}for(var j=0,k=n.length;j<k;j++){var m=n[j];if(m.allowNull&&l[m.inputName]==null){return}if(!m.allowNull&&l[m.inputName]==null){throw"Property "+m.inputName+" cannot be null"}if(m.inputType&&typeof l[m.inputName]!==m.inputType){throw"Property "+m.inputName+" must be of type "+m.inputType}if(m.inputConstructor&&l[m.inputName].constructor!==m.inputConstructor){throw {message:"Property "+m.inputName+" must be of a give type",type:m.inputConstructor}}}};return g})();e.Sanitizer=d})(c||(c={}));var a=this.__extends||function(g,f){function e(){this.constructor=g}e.prototype=f.prototype;g.prototype=new e()};var c;(function(e){var d=(function(f){a(g,f);function g(h){f.call(this,h);e.Sanitizer.Require(h,{inputName:"Operand",inputType:"object"});this.Operand=e.Expression.CreateExpression(h.Operand)}g.OperatorDictionary=(function(){var h=[];h[e.Meta.ExpressionType.Convert]=function(i){return i};h[e.Meta.ExpressionType.Not]=function(i){return !i};return h})();g.OperatorStringDictionary=(function(){var h=[];h[e.Meta.ExpressionType.Convert]=function(i){return i};h[e.Meta.ExpressionType.Not]=function(i){return"!"+i};return h})();g.prototype.EvalExpression=function(){var h=this.Operand.EvalExpression();return{Expression:"("+g.OperatorStringDictionary[this.NodeType](h.Expression)+")",Constants:h.Constants}};g.prototype._Compile=function(){var h=this;var i=this.Operand.Compile();return function(j){return g.OperatorDictionary[h.NodeType](i(j))}};return g})(e.Expression);e.UnaryExpression=d})(c||(c={}));var b=(function(){function d(){}d.createExpression=c.Expression.CreateExpression;d.registeredConstructors=c.NewExpression.RegisteredTypes;d.registeredMethods=c.MethodCallExpression.RegisteredMethods;return d})();window.ex=b})();